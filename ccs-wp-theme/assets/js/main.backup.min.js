!function(){"use strict";const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname;let t=0;function n(){t=window.pageYOffset||document.documentElement.scrollTop,document.documentElement.style.overflow="hidden",document.documentElement.style.position="fixed",document.documentElement.style.width="100%",document.documentElement.style.top=`-${t}px`,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${t}px`}function o(){document.documentElement.style.overflow="",document.documentElement.style.position="",document.documentElement.style.width="",document.documentElement.style.top="",document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.top="",window.scrollTo(0,t)}window.toggleMobileMenu=function(){const e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-button");if(!e||!t)return;e.classList.contains("active")||"block"===e.style.display?(e.style.display="none",e.style.visibility="hidden",e.classList.remove("active"),t.setAttribute("aria-expanded","false"),o()):(e.style.display="block",e.style.visibility="visible",e.classList.add("active"),t.setAttribute("aria-expanded","true"),n())},window.closeMobileMenu=function(){const e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-button");e&&(e.style.display="none",e.style.visibility="hidden",e.classList.remove("active"),o()),t&&t.setAttribute("aria-expanded","false")},window.openMobileMenu=function(){const e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-button");e&&(e.style.display="block",e.style.visibility="visible",e.classList.add("active"),n()),t&&t.setAttribute("aria-expanded","true")};window.addEventListener("error",(function(e){const t=e.message||e.error?.message||"";if(t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist"))return e.preventDefault(),e.stopPropagation(),!1}),!0),window.addEventListener("unhandledrejection",(function(e){const t=e.reason?.message||String(e.reason||"");if(t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist"))return e.preventDefault(),!1}));const i={isSearchOpen:!1,isCoursesOpen:!1,isGroupTrainingOpen:!1,isMobileMenuOpen:!1,isMobileCoursesOpen:!1,isMobileGroupTrainingOpen:!1,coursesTimeout:null,groupTrainingTimeout:null,focusableElements:[],lastFocusedElement:null},s=document.getElementById("search-button"),r=document.getElementById("search-modal"),a=r?.querySelector(".search-modal-container"),c=document.getElementById("search-modal-input"),l=document.getElementById("search-modal-close"),d=document.getElementById("search-autocomplete");let u=null;const m=document.getElementById("courses-link"),p=document.getElementById("courses-dropdown"),f=p?.querySelector(".mega-menu-close"),b=m?.closest(".nav-item-dropdown"),y=document.getElementById("group-training-link"),g=document.getElementById("group-training-dropdown"),v=y?.closest(".nav-item-dropdown"),h=(document.querySelector("main")||document.body,document.getElementById("mobile-menu-button")),w=(document.getElementById("mobile-menu"),document.getElementById("mobile-menu-content")),E=document.getElementById("mobile-courses-accordion"),L=document.getElementById("mobile-courses-content"),x=document.getElementById("mobile-group-training-accordion"),k=document.getElementById("mobile-group-training-content");function A(){i.isSearchOpen=!0,r&&(r.classList.add("active"),r.setAttribute("aria-hidden","false"),n(),setTimeout((()=>{c&&c.focus()}),100))}function S(){i.isSearchOpen=!1,r&&(c&&(c.blur(),c.value=""),r.classList.remove("active"),r.setAttribute("aria-hidden","true"),o(),d&&(d.style.display="none",d.innerHTML=""),u&&(clearTimeout(u),u=null),s&&window.innerWidth>=768&&setTimeout((()=>{s.focus()}),100))}function T(){if(!c)return;const e=c.value.trim();if(!e)return;if(!(window.location.pathname.includes("courses.html")||window.location.pathname.endsWith("courses.html")||window.location.pathname.endsWith("/courses"))){const t=new URLSearchParams;return t.set("search",e),void(window.location.href=`courses.html?${t.toString()}`)}{const t=document.getElementById("course-search");if(t){t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0}));const n=document.getElementById("courses-filter-section");n&&n.scrollIntoView({behavior:"smooth",block:"start"})}}S()}function I(e){if(!d)return;if(!e||""===e.trim())return d.style.display="none",void(d.innerHTML="");const t=function(e){if(!e||""===e.trim()||!window.CourseDataManager)return[];const t=window.CourseDataManager.getCourses(),n=e.toLowerCase().trim();return t.map((e=>{let t=0;const o=e.title.toLowerCase(),i=(e.description||"").toLowerCase(),s=(e.category||"").toLowerCase(),r=(e.topics||[]).map((e=>e.toLowerCase()));return o===n?t+=100:o.startsWith(n)?t+=80:o.includes(n)&&(t+=60),s&&s.includes(n)&&(t+=70),r&&r.some((e=>e.includes(n)))&&(t+=40),i.includes(n)&&(t+=30),{course:e,score:t}})).filter((e=>e.score>0)).sort(((e,t)=>t.score-e.score)).slice(0,8).map((e=>e.course))}(e);if(0===t.length)return d.innerHTML=`\n        <div class="search-autocomplete-empty" role="status" aria-live="polite">\n          <i class="fas fa-search search-autocomplete-icon" aria-hidden="true"></i>\n          <span class="search-autocomplete-text">\n            No courses found for "${e}"\n          </span>\n        </div>\n      `,void(d.style.display="block");d.innerHTML=t.map(((t,n)=>{const o=function(e,t){if(!t||""===t.trim())return e;const n=e.toLowerCase(),o=t.toLowerCase().trim(),i=n.indexOf(o);return-1===i?e:`${e.substring(0,i)}<mark class="search-autocomplete-highlight">${e.substring(i,i+t.length)}</mark>${e.substring(i+t.length)}`}(t.title,e),i=t.category?`<span class="search-autocomplete-category">${t.category}</span>`:"",s=t.level?`<span class="search-autocomplete-level">${t.level}</span>`:"";return`\n        <button\n          type="button"\n          class="search-autocomplete-item"\n          role="option"\n          aria-selected="false"\n          data-course-id="${t.id}"\n          data-course-title="${t.title}"\n          tabindex="0"\n        >\n          <i class="fas fa-search search-autocomplete-icon" aria-hidden="true"></i>\n          <span class="search-autocomplete-text">\n            ${o}\n            <span class="search-autocomplete-meta">\n              ${s}\n            ${i}\n            </span>\n          </span>\n        </button>\n      `})).join(""),d.style.display="block";d.querySelectorAll(".search-autocomplete-item").forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-course-title");t&&c&&(c.value=t,T())}))}))}function M(){i.coursesTimeout&&(clearTimeout(i.coursesTimeout),i.coursesTimeout=null),i.isCoursesOpen=!0,i.lastFocusedElement=document.activeElement,m&&m.setAttribute("aria-expanded","true"),p&&(p.classList.add("active"),p.setAttribute("aria-hidden","false"),C(),B(!0))}function C(){p&&(i.focusableElements=Array.from(p.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])')),document.addEventListener("keydown",D,!0),document.addEventListener("keydown",Y,!0))}function B(e){if(!p)return;p.querySelectorAll('[role="menuitem"]').forEach((t=>{e?t.setAttribute("tabindex","0"):t.setAttribute("tabindex","-1")})),f&&f.setAttribute("tabindex",e?"0":"-1")}function O(){i.coursesTimeout=setTimeout((()=>{q()}),150)}function q(){i.isCoursesOpen=!1,m&&m.setAttribute("aria-expanded","false"),p&&(p.classList.remove("active"),p.setAttribute("aria-hidden","true")),document.removeEventListener("keydown",D,!0),document.removeEventListener("keydown",Y,!0),i.focusableElements=[],B(!1),i.lastFocusedElement&&"function"==typeof i.lastFocusedElement.focus&&i.lastFocusedElement.focus()}function D(e){if("Tab"!==e.key||!i.isCoursesOpen||!p)return;if(i.focusableElements=Array.from(p.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])')),0===i.focusableElements.length)return;const t=i.focusableElements[0],n=i.focusableElements[i.focusableElements.length-1],o=document.activeElement;p.contains(o)||o===m?e.shiftKey?o===t&&setTimeout((()=>{const e=document.activeElement;p.contains(e)||q()}),0):o===n&&setTimeout((()=>{const e=document.activeElement;p.contains(e)||q()}),0):q()}function Y(e){if(!i.isCoursesOpen||!p)return;const t=document.activeElement,n=i.focusableElements,o=n.indexOf(t);if(-1===o)return;let s=o;switch(e.key){case"ArrowDown":e.preventDefault(),s=(o+1)%n.length;break;case"ArrowUp":e.preventDefault(),s=(o-1+n.length)%n.length;break;case"Home":e.preventDefault(),s=0;break;case"End":e.preventDefault(),s=n.length-1;break;case"Escape":return e.preventDefault(),void q();default:return}n[s]?.focus()}function R(){const e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-button"),o=document.getElementById("mobile-menu-content");if(e){if(i.isMobileMenuOpen=!0,e.style.display="block",e.style.visibility="visible",e.classList.add("active"),n(),t){t.setAttribute("aria-expanded","true"),t.setAttribute("aria-label","Close menu");const e=t.querySelector("#mobile-menu-icon");if(e)if("SVG"===e.tagName){const t=e.querySelectorAll("path");t.length>=3&&(t[0].setAttribute("d","M6 18L18 6"),t[1].setAttribute("d","M6 6l12 12"),t[2]&&(t[2].style.display="none"))}else e.classList.remove("fa-bars"),e.classList.add("fa-times")}setTimeout((()=>{if(o){const e=o.querySelector("button, a");e?.focus()}}),100)}else console.error("Mobile menu element #mobile-menu not found!")}function G(){const e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-button");if(i.isMobileMenuOpen=!1,e&&(e.classList.remove("active"),e.style.display="none",e.style.visibility="hidden",o()),t){t.setAttribute("aria-expanded","false"),t.setAttribute("aria-label","Open menu");const e=t.querySelector("#mobile-menu-icon");if(e)if("SVG"===e.tagName){const t=e.querySelectorAll("path");t.length>=3&&(t[0].setAttribute("d","M4 6h16"),t[1].setAttribute("d","M4 12h16"),t[2].setAttribute("d","M4 18h16"),t[2]&&(t[2].style.display=""))}else e.classList.remove("fa-times"),e.classList.add("fa-bars");t.focus()}}function F(){i.isMobileCoursesOpen=!i.isMobileCoursesOpen,E&&E.setAttribute("aria-expanded",i.isMobileCoursesOpen.toString()),L&&(i.isMobileCoursesOpen?L.classList.add("active"):L.classList.remove("active"))}function $(){i.isMobileGroupTrainingOpen=!i.isMobileGroupTrainingOpen,x&&x.setAttribute("aria-expanded",i.isMobileGroupTrainingOpen.toString()),k&&(i.isMobileGroupTrainingOpen?k.classList.add("active"):k.classList.remove("active"))}window.toggleMobileMenu=function(){try{i.isMobileMenuOpen?G():R()}catch(e){console.error("Error in toggleMobileMenu:",e)}},window.closeMobileMenu=G,window.openMobileMenu=R,s&&s.addEventListener("click",(()=>{A()})),l&&l.addEventListener("click",(()=>{S()}));const W=document.getElementById("search-modal-submit");W&&W.addEventListener("click",T),c&&(c.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),T())})),c.addEventListener("input",(function(){if(!c)return;u&&clearTimeout(u);const e=c.value;u=setTimeout((()=>{I(e)}),300)})));const H=r?.querySelector(".search-modal-backdrop");function P(){const e=document.getElementById("mobile-menu-button");e&&!e.dataset.handlerAttached&&(e.dataset.handlerAttached="true",e.removeAttribute("onclick"),e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),window.toggleMobileMenu()})))}H&&H.addEventListener("click",S),a&&a.addEventListener("click",(e=>{e.stopPropagation()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&(i.isCoursesOpen?(e.preventDefault(),q()):i.isSearchOpen?S():i.isMobileMenuOpen&&G())})),document.addEventListener("keydown",(function(e){if(!i.isSearchOpen||!a)return;if("Tab"!==e.key)return;const t=a.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],o=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),o?.focus()):document.activeElement===o&&(e.preventDefault(),n?.focus())})),m&&p&&b&&(b.addEventListener("mouseenter",M),b.addEventListener("mouseleave",O),m.addEventListener("focus",(function(){i.isCoursesOpen||(i.isCoursesOpen=!0,i.lastFocusedElement=document.activeElement,m&&m.setAttribute("aria-expanded","true"),p&&(p.classList.add("active"),p.setAttribute("aria-hidden","false"),C(),B(!0),setTimeout((()=>{const e=p.querySelector('[role="menuitem"]');e&&e.focus()}),50)))})),m.addEventListener("blur",(function(e){b&&!b.contains(e.relatedTarget)&&setTimeout((()=>{i.isCoursesOpen=!1,m&&m.setAttribute("aria-expanded","false"),p&&p.classList.remove("active")}),150)})),m.addEventListener("keydown",(function(e){"Enter"===e.key||" "===e.key?(e.preventDefault(),i.isCoursesOpen?q():(M(),setTimeout((()=>{const e=p?.querySelector('[role="menuitem"]');e&&e.focus()}),50))):"Escape"===e.key?i.isCoursesOpen&&(e.preventDefault(),q()):"ArrowDown"!==e.key||i.isCoursesOpen||(e.preventDefault(),M(),setTimeout((()=>{const e=p?.querySelector('[role="menuitem"]');e&&e.focus()}),50))})),p.addEventListener("mouseenter",(()=>{i.coursesTimeout&&(clearTimeout(i.coursesTimeout),i.coursesTimeout=null),i.isCoursesOpen||M()})),p.addEventListener("mouseleave",O),p.querySelectorAll("a").forEach((e=>{e.addEventListener("keydown",(e=>{"Escape"===e.key&&q()}))}))),f&&f.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),q()})),document.addEventListener("click",(e=>{if(i.isCoursesOpen&&p&&b){b.contains(e.target)||p.contains(e.target)||q()}})),y&&g&&v&&(v.addEventListener("mouseenter",(function(){i.groupTrainingTimeout&&(clearTimeout(i.groupTrainingTimeout),i.groupTrainingTimeout=null),i.isGroupTrainingOpen=!0,g&&g.classList.add("active")})),v.addEventListener("mouseleave",(function(){i.groupTrainingTimeout=setTimeout((()=>{i.isGroupTrainingOpen=!1,g&&g.classList.remove("active")}),150)})),y.addEventListener("focus",(function(){i.isGroupTrainingOpen=!0,g&&g.classList.add("active")})),y.addEventListener("blur",(function(e){v&&!v.contains(e.relatedTarget)&&setTimeout((()=>{i.isGroupTrainingOpen=!1,g&&g.classList.remove("active")}),150)})),y.addEventListener("keydown",(function(e){if("ArrowDown"===e.key&&i.isGroupTrainingOpen){e.preventDefault();const t=g?.querySelector("a");t?.focus()}else"Escape"===e.key&&(i.isGroupTrainingOpen=!1,y&&y.focus(),g&&g.classList.remove("active"))})),g.querySelectorAll("a").forEach((e=>{e.addEventListener("keydown",(e=>{"Escape"===e.key&&(i.isGroupTrainingOpen=!1,y&&y.focus(),g&&g.classList.remove("active"))}))}))),P(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",P):setTimeout(P,0);new MutationObserver((function(e){P()})).observe(document.body,{childList:!0,subtree:!0}),setTimeout(P,500);const z=document.getElementById("mobile-search-button");if(z&&z.addEventListener("click",(()=>{A(),G()})),w&&w.querySelectorAll("a").forEach((e=>{e.addEventListener("click",G)})),E&&E.addEventListener("click",F),x&&x.addEventListener("click",$),m&&m.setAttribute("aria-expanded","false"),p&&(p.setAttribute("aria-hidden","true"),B(!1)),h&&h.setAttribute("aria-expanded","false"),r&&r.setAttribute("aria-hidden","true"),E&&E.setAttribute("aria-expanded","false"),x&&x.setAttribute("aria-expanded","false"),window.addEventListener("resize",(()=>{window.innerWidth>=768&&i.isMobileMenuOpen&&G()})),window.openSearchModal=A,window.closeSearchModal=S,window.handleSearchModalSubmit=T,window.toggleMobileCourses=F,window.toggleMobileGroupTraining=$,window.innerWidth>=1024){const e=document.querySelector("#main-content > section.about-cta-modern"),t=e?.querySelector(".about-cta-modern-image");if(e&&t){let n=!1,o=window.scrollY;const i=function(){n||(window.requestAnimationFrame((function(){const i=window.scrollY,s=e.getBoundingClientRect(),r=window.innerHeight;if(s.top<r&&s.bottom>0){const e=i-o,n=t.style.transform||"translateY(0px)",s=parseFloat(n.match(/translateY\((-?\d+\.?\d*)px\)/)?.[1]||0),r=Math.max(-4,Math.min(0,s-.1*e));t.style.transform=`translateY(${r}px)`}else t.style.transform="";o=i,n=!1})),n=!0)};window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",(function(){window.innerWidth<1024&&t&&(t.style.transform="")}))}}const N=document.querySelectorAll(".about-cta-modern-stat-card");if(N.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&(t.target.style.animationPlayState="running",e.unobserve(t.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"});N.forEach((function(t){t.style.animationPlayState="paused",e.observe(t)}))}const V=document.querySelectorAll(".process-card");if(V.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&(t.target.classList.add("process-visible"),e.unobserve(t.target))}))}),{threshold:.15,rootMargin:"0px 0px -80px 0px"});V.forEach((function(t){e.observe(t)}))}function K(){const e=document.querySelector(".process-card-1"),t=document.querySelector(".process-card-2"),n=document.querySelector(".process-card-3"),o=document.querySelector(".process-connector-1-2"),i=document.querySelector(".process-connector-2-3"),s=document.querySelector(".process-grid");if(!(e&&t&&n&&o&&i&&s))return;const r=s.getBoundingClientRect(),a=(e.getBoundingClientRect(),t.getBoundingClientRect(),n.getBoundingClientRect(),e.querySelector(".process-number-circle")),c=t.querySelector(".process-number-circle"),l=n.querySelector(".process-number-circle");if(!a||!c||!l)return;const d=a.getBoundingClientRect(),u=c.getBoundingClientRect(),m=l.getBoundingClientRect(),p=d.bottom-r.top,f=u.top-r.top,b=d.left+d.width/2-r.left;o.style.left=b+"px",o.style.top=p+"px",o.style.height=f-p+"px";const y=u.bottom-r.top,g=m.top-r.top,v=u.left+u.width/2-r.left;i.style.left=v+"px",i.style.top=y+"px",i.style.height=g-y+"px"}document.querySelector(".process-grid")&&(K(),window.addEventListener("resize",K),setTimeout(K,1e3));const U=document.getElementById("booking-enquiry-form");function _(){const e=document.getElementById("categories-load-more"),t=document.querySelectorAll(".category-card-hidden");e&&t.length>0&&(e.getAttribute("aria-label")||e.setAttribute("aria-label","Show all training categories"),e.addEventListener("click",(function(){const n="true"===e.getAttribute("aria-expanded"),o=e.querySelector(".load-more-text");n?(t.forEach((e=>{e.classList.remove("category-card-visible")})),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Show all training categories"),o&&(o.textContent="View All Categories")):(t.forEach((e=>{e.classList.add("category-card-visible")})),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Hide additional training categories"),o&&(o.textContent="Show Less Categories"),t[0]&&t[0].scrollIntoView({behavior:"smooth",block:"nearest"}))})))}function j(){if(window.innerWidth<768){document.querySelectorAll("#mobile-menu-content .mobile-menu-link").forEach((e=>{e.classList.remove("active"),e.removeAttribute("data-active"),e.removeAttribute("aria-current")}));document.getElementById("mobile-menu-content")}}U&&U.addEventListener("submit",(function(e){e.preventDefault();const t=document.getElementById("booking-consent");if(!t||!t.checked)return alert("Please provide consent to be contacted before submitting your enquiry."),void t.focus();const n=new FormData(U),o=n.get("name"),i=n.get("email"),s=n.get("phone")||"Not provided",r=n.get("interest"),a="mailto:enquiries@continuitytrainingacademy.co.uk?subject="+encodeURIComponent("Training Booking Enquiry from "+o)+"&body="+encodeURIComponent("New booking enquiry:\n\nName: "+o+"\nEmail: "+i+"\nPhone: "+s+"\nInterested in: "+r+"\nConsent to contact: Yes\n\nPlease contact them to discuss their training needs.");window.showThankYouModal?(window.showThankYouModal("Thanks for your booking enquiry! We've received it and will be in touch soon.",{nextSteps:"We'll send you booking details via email shortly."}),setTimeout((function(){window.location.href=a}),300)):window.location.href=a,U.reset(),t&&(t.checked=!1)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",_):_(),document.getElementById("homepage-sticky-cta")&&function(){try{const t=document.getElementById("homepage-sticky-cta"),n=document.getElementById("cta-centered-section");if(!t)return;let o=0,i=!1;function s(){i||(window.requestAnimationFrame((()=>{try{const e=window.pageYOffset||document.documentElement.scrollTop,i=window.innerWidth<768,s=document.querySelector(".site-footer, .site-footer-modern");if(e>200)if(i){if(n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0?(t.classList.remove("visible"),t.classList.add("hidden-mobile")):t.classList.remove("hidden-mobile")}if(s){if(s.getBoundingClientRect().top<window.innerHeight+300)t.classList.remove("visible"),t.classList.add("hidden-near-footer");else if(t.classList.remove("hidden-near-footer"),n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0||t.classList.add("visible")}else t.classList.add("visible")}else if(n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0||(t.classList.remove("hidden-mobile"),t.classList.add("visible"))}else t.classList.add("visible")}else t.classList.add("visible");else t.classList.remove("visible"),t.classList.remove("hidden-mobile"),t.classList.remove("hidden-near-footer");o=e}catch(t){e&&console.error("Error in sticky CTA scroll handler:",t)}finally{i=!1}})),i=!0)}t.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation();try{n?(n.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout((()=>{try{const e=n.querySelector('input[type="text"], input[type="tel"], input[type="email"]');e&&e.focus()}catch(t){e&&console.warn("Could not focus form input:",t)}}),500)):window.location.href="contact.html"}catch(t){e&&console.error("Error in sticky CTA click handler:",t)}})),s(),window.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0})}catch(r){e&&console.error("Error initializing sticky CTA:",r)}}(),document.getElementById("exit-intent-modal")&&function(){try{const t=document.getElementById("exit-intent-modal"),n=document.getElementById("exit-intent-form"),o=document.getElementById("exit-intent-email"),i=t?.querySelector(".exit-intent-modal-close"),s=t?.querySelector(".exit-intent-dismiss"),r=t?.querySelector(".exit-intent-modal-backdrop");if(!t)return;let a,c,l;try{a=localStorage.getItem("exitIntentDismissed"),c=localStorage.getItem("exitIntentDate"),l=(new Date).toDateString()}catch(v){e&&console.warn("localStorage not available for exit-intent popup")}if("true"===a&&c===l)return;let d=!1,u=0,m=null;function p(e){d||(m&&clearTimeout(m),m=setTimeout((()=>{!e.relatedTarget&&!e.toElement&&e.clientY<10&&(d=!0,f())}),100))}function f(){try{t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),o=n[0],i=n[n.length-1];function s(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),i?.focus()):document.activeElement===i&&(e.preventDefault(),o?.focus()))}o&&setTimeout((()=>{try{o.focus()}catch(t){e&&console.warn("Could not focus exit-intent modal element:",t)}}),100),t.addEventListener("keydown",s),t._trapFocus=s}catch(r){e&&console.error("Error showing exit-intent modal:",r)}}function b(){try{t.setAttribute("aria-hidden","true"),document.body.style.overflow="",t._trapFocus&&(t.removeEventListener("keydown",t._trapFocus),delete t._trapFocus)}catch(t){e&&console.error("Error closing exit-intent modal:",t)}}function y(){try{"undefined"!=typeof localStorage&&(localStorage.setItem("exitIntentDismissed","true"),localStorage.setItem("exitIntentDate",l))}catch(t){e&&console.warn("Could not save exit-intent preference:",t)}}function g(e){"Escape"===e.key&&"false"===t.getAttribute("aria-hidden")&&b()}document.addEventListener("mouseout",p,!1),document.addEventListener("mousemove",(e=>{u=e.clientY}),{passive:!0}),i&&i.addEventListener("click",(()=>{y(),b()})),s&&s.addEventListener("click",(()=>{y(),b()})),r&&r.addEventListener("click",(()=>{y(),b()})),document.addEventListener("keydown",g),n&&n.addEventListener("submit",(t=>{t.preventDefault();try{const e=o?.value;e&&("undefined"!=typeof localStorage&&(localStorage.setItem("exitIntentSubmitted","true"),localStorage.setItem("exitIntentDate",l)),b())}catch(t){e&&console.error("Error submitting exit-intent form:",t)}}))}catch(h){e&&console.error("Error initializing exit-intent popup:",h)}}(),j(),window.addEventListener("resize",j,{passive:!0}),window.addEventListener("scroll",(()=>{window.innerWidth<768&&j()}),{passive:!0});const Q=document.getElementById("mobile-menu-content");function J(){const e=document.getElementById("footer-newsletter-form");e&&"true"!==e.dataset?.ctaBound&&(e.dataset.ctaBound="true",e.addEventListener("submit",(t=>{t.preventDefault();const n=e.querySelector('input[type="email"]'),o=e.querySelector('input[name="consent"]');if(o&&!o.checked)return void o.focus();n?.value?.trim()??""?("function"==typeof window.showThankYouModal?window.showThankYouModal("You're all set! We're excited to share training insights and CQC updates with you.",{nextSteps:"Keep an eye on your inboxâ€”we'll send you the latest news and training opportunities. You can unsubscribe anytime."}):alert("You're all set! We're excited to share training insights and CQC updates with you."),e.reset()):n?.focus()})))}Q&&Q.addEventListener("click",(e=>{if(e.target.classList.contains("mobile-menu-link")){document.querySelectorAll("#mobile-menu-content .mobile-menu-link").forEach((t=>{t!==e.target&&(t.classList.remove("active"),t.removeAttribute("data-active"),t.removeAttribute("aria-current"))}))}}),{passive:!0}),function(){const e=document.getElementById("back-to-top");if(!e)return;function t(){(window.pageYOffset||document.documentElement.scrollTop)>300?(e.classList.add("visible"),e.setAttribute("aria-hidden","false")):(e.classList.remove("visible"),e.setAttribute("aria-hidden","true"))}let n=!1;e.addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("main-content");t&&(t.setAttribute("tabindex","-1"),t.focus(),setTimeout((()=>{t.removeAttribute("tabindex")}),100)),window.scrollTo({top:0,behavior:"smooth"})})),window.addEventListener("scroll",(function(){n||(window.requestAnimationFrame((function(){t(),n=!1})),n=!0)}),{passive:!0}),t()}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",J):J()}();