!function(){"use strict";const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,t={selectors:{header:"#header",mobileMenu:"#mobile-menu",mobileButton:"#mobile-menu-button",wrapper:".header-inner-wrapper",searchButton:"#search-button",mobileSearchButton:"#mobile-search-button"},classes:{active:"active",overflow:"header--overflow",menuOpen:"menu-open"},breakpoints:{mobile:1023,desktop:1024}};let n=0;const o={lock(){n=window.scrollY,document.body.style.top=`-${n}px`,document.body.classList.add(t.classes.menuOpen)},unlock(){document.body.classList.remove(t.classes.menuOpen),document.body.style.top="",window.scrollTo(0,n)}},i={elements:{menu:null,button:null},init(){return this.elements.menu=document.querySelector(t.selectors.mobileMenu),this.elements.button=document.querySelector(t.selectors.mobileButton),this.elements.menu&&this.elements.button?(this.elements.button.addEventListener("click",(()=>this.toggle())),!0):(e&&console.warn("Header: Mobile menu elements not found"),!1)},isOpen(){return this.elements.menu?.classList.contains(t.classes.active)||!1},open(){if(!this.elements.menu||!this.elements.button)return;this.elements.menu.classList.add(t.classes.active),this.elements.button.setAttribute("aria-expanded","true"),this.elements.button.setAttribute("aria-label","Close menu"),o.lock();const e=this.elements.button.querySelector("#mobile-menu-icon, .mobile-menu-icon");if(e&&"SVG"===e.tagName){const t=e.querySelectorAll("path");t.length>=3&&(t[0].setAttribute("d","M6 18L18 6"),t[1].setAttribute("d","M6 6l12 12"),t[2]&&(t[2].style.display="none"))}setTimeout((()=>{const e=this.elements.menu.querySelector("a, button");e?.focus()}),100)},close(){if(!this.elements.menu||!this.elements.button)return;this.elements.menu.classList.remove(t.classes.active),this.elements.button.setAttribute("aria-expanded","false"),this.elements.button.setAttribute("aria-label","Open menu"),o.unlock();const e=this.elements.button.querySelector("#mobile-menu-icon, .mobile-menu-icon");if(e&&"SVG"===e.tagName){const t=e.querySelectorAll("path");t.length>=3&&(t[0].setAttribute("d","M4 6h16"),t[1].setAttribute("d","M4 12h16"),t[2].setAttribute("d","M4 18h16"),t[2]&&(t[2].style.display=""))}this.elements.button.focus()},toggle(){this.isOpen()?this.close():this.open()}},s={enabled:!1,init(){if(!this.enabled)return;const e=document.querySelector(t.selectors.header),n=e?.querySelector(t.selectors.wrapper);if(!e||!n)return;const o=()=>{const o=n.scrollWidth>n.clientWidth;e.classList.toggle(t.classes.overflow,o)};if("ResizeObserver"in window){new ResizeObserver(o).observe(n)}else window.addEventListener("resize",this.debounce(o,150));o()},debounce(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>e.apply(this,o)),t)}}},r={init(){let e;document.addEventListener("keydown",(e=>{"Escape"===e.key&&i.isOpen()&&i.close()})),document.addEventListener("click",(e=>{if(!i.isOpen())return;const t=i.elements.menu,n=i.elements.button;t?.contains(e.target)||n?.contains(e.target)||i.close()})),window.addEventListener("resize",(()=>{clearTimeout(e),e=setTimeout((()=>{window.innerWidth>=t.breakpoints.desktop&&i.isOpen()&&i.close()}),150)}));const n=document.querySelector(t.selectors.mobileSearchButton);n&&n.addEventListener("click",(()=>{"function"==typeof window.openSearchModal&&window.openSearchModal(),i.close()}));const o=document.querySelector(t.selectors.searchButton);o&&o.addEventListener("click",(()=>{"function"==typeof window.openSearchModal&&window.openSearchModal()}))}};function a(){i.init()&&e&&console.log("Header: Mobile menu initialized"),s.init(),r.init()}window.toggleMobileMenu=function(){i.elements.menu||i.init(),i.toggle()},window.closeMobileMenu=function(){i.elements.menu||i.init(),i.close()},window.openMobileMenu=function(){i.elements.menu||i.init(),i.open()},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a();window.addEventListener("error",(function(e){const t=e.message||e.error?.message||"";if(t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist"))return e.preventDefault(),e.stopPropagation(),!1}),!0),window.addEventListener("unhandledrejection",(function(e){const t=e.reason?.message||String(e.reason||"");if(t.includes("message channel closed")||t.includes("asynchronous response")||t.includes("Extension context invalidated")||t.includes("Receiving end does not exist"))return e.preventDefault(),!1}));const c={isSearchOpen:!1,isCoursesOpen:!1,isGroupTrainingOpen:!1,isMobileMenuOpen:!1,isMobileCoursesOpen:!1,isMobileGroupTrainingOpen:!1,coursesTimeout:null,groupTrainingTimeout:null,focusableElements:[],lastFocusedElement:null},l=document.getElementById("search-button"),u=document.getElementById("search-modal"),d=u?.querySelector(".search-modal-container"),m=document.getElementById("search-modal-input"),p=document.getElementById("search-modal-close"),f=document.getElementById("search-autocomplete");let b=null,h=null;const v=document.getElementById("courses-link"),g=document.getElementById("courses-dropdown");const y=g?.querySelector(".mega-menu-close"),w=v?.closest(".nav-item-dropdown"),E=document.getElementById("group-training-link"),L=document.getElementById("group-training-dropdown"),k=E?.closest(".nav-item-dropdown"),S=(document.querySelector("main")||document.body,document.getElementById("mobile-menu-button")),x=(document.getElementById("mobile-menu"),document.getElementById("mobile-menu-content")),T=document.getElementById("mobile-courses-accordion"),A=document.getElementById("mobile-courses-content"),M=document.getElementById("mobile-group-training-accordion"),C=document.getElementById("mobile-group-training-content");function O(){c.isSearchOpen=!0,u&&(u.classList.add("active"),u.setAttribute("aria-hidden","false"),lockBodyScroll(),setTimeout((()=>{m&&m.focus()}),100),function(){if(!u)return;const e=u.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(0===e.length)return;const t=e[0],n=e[e.length-1];h=function(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),t.focus()))},u.addEventListener("keydown",h)}())}function q(){c.isSearchOpen=!1,u&&(m&&(m.blur(),m.value=""),u.classList.remove("active"),u.setAttribute("aria-hidden","true"),unlockBodyScroll(),f&&(f.style.display="none",f.innerHTML=""),b&&(clearTimeout(b),b=null),u&&h&&(u.removeEventListener("keydown",h),h=null),l&&window.innerWidth>=t.breakpoints.desktop&&setTimeout((()=>{l.focus()}),100))}function I(){if(!m)return;const e=m.value.trim();if(!e)return;if(!(window.location.pathname.includes("courses.html")||window.location.pathname.endsWith("courses.html")||window.location.pathname.endsWith("/courses"))){const t=new URLSearchParams;return t.set("search",e),void(window.location.href=`courses.html?${t.toString()}`)}{const t=document.getElementById("course-search");if(t){t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0}));const n=document.getElementById("courses-filter-section");n&&n.scrollIntoView({behavior:"smooth",block:"start"})}}q()}function B(e){if(!f)return;if(!e||""===e.trim())return f.style.display="none",void(f.innerHTML="");const t=function(e){if(!e||""===e.trim()||!window.CourseDataManager)return[];const t=window.CourseDataManager.getCourses(),n=e.toLowerCase().trim();return t.map((e=>{let t=0;const o=e.title.toLowerCase(),i=(e.description||"").toLowerCase(),s=(e.category||"").toLowerCase(),r=(e.topics||[]).map((e=>e.toLowerCase()));return o===n?t+=100:o.startsWith(n)?t+=80:o.includes(n)&&(t+=60),s&&s.includes(n)&&(t+=70),r&&r.some((e=>e.includes(n)))&&(t+=40),i.includes(n)&&(t+=30),{course:e,score:t}})).filter((e=>e.score>0)).sort(((e,t)=>t.score-e.score)).slice(0,8).map((e=>e.course))}(e);if(0===t.length)return f.innerHTML=`\n        <div class="search-autocomplete-empty" role="status" aria-live="polite">\n          <i class="fas fa-search search-autocomplete-icon" aria-hidden="true"></i>\n          <span class="search-autocomplete-text">\n            No courses found for "${e}"\n          </span>\n        </div>\n      `,void(f.style.display="block");f.innerHTML=t.map(((t,n)=>{const o=function(e,t){if(!t||""===t.trim())return e;const n=e.toLowerCase(),o=t.toLowerCase().trim(),i=n.indexOf(o);return-1===i?e:`${e.substring(0,i)}<mark class="search-autocomplete-highlight">${e.substring(i,i+t.length)}</mark>${e.substring(i+t.length)}`}(t.title,e),i=t.category?`<span class="search-autocomplete-category">${t.category}</span>`:"",s=t.level?`<span class="search-autocomplete-level">${t.level}</span>`:"";return`\n        <button\n          type="button"\n          class="search-autocomplete-item"\n          role="option"\n          aria-selected="false"\n          data-course-id="${t.id}"\n          data-course-title="${t.title}"\n          tabindex="0"\n        >\n          <i class="fas fa-search search-autocomplete-icon" aria-hidden="true"></i>\n          <span class="search-autocomplete-text">\n            ${o}\n            <span class="search-autocomplete-meta">\n              ${s}\n            ${i}\n            </span>\n          </span>\n        </button>\n      `})).join(""),f.style.display="block";f.querySelectorAll(".search-autocomplete-item").forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-course-title");t&&m&&(m.value=t,I())}))}))}function D(){c.coursesTimeout&&(clearTimeout(c.coursesTimeout),c.coursesTimeout=null),c.isCoursesOpen=!0,c.lastFocusedElement=document.activeElement,v&&v.setAttribute("aria-expanded","true"),g&&(g.classList.add("active"),g.setAttribute("aria-hidden","false"),R(),Y(!0))}function R(){g&&(c.focusableElements=Array.from(g.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])')),document.addEventListener("keydown",F,!0),document.addEventListener("keydown",$,!0))}function Y(e){if(!g)return;g.querySelectorAll('[role="menuitem"]').forEach((t=>{e?t.setAttribute("tabindex","0"):t.setAttribute("tabindex","-1")})),y&&y.setAttribute("tabindex",e?"0":"-1")}function W(){c.coursesTimeout=setTimeout((()=>{G()}),150)}function G(){c.isCoursesOpen=!1,v&&v.setAttribute("aria-expanded","false"),g&&(g.classList.remove("active"),g.setAttribute("aria-hidden","true")),document.removeEventListener("keydown",F,!0),document.removeEventListener("keydown",$,!0),c.focusableElements=[],Y(!1),c.lastFocusedElement&&"function"==typeof c.lastFocusedElement.focus&&c.lastFocusedElement.focus()}function F(e){if("Tab"!==e.key||!c.isCoursesOpen||!g)return;if(c.focusableElements=Array.from(g.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])')),0===c.focusableElements.length)return;const t=c.focusableElements[0],n=c.focusableElements[c.focusableElements.length-1],o=document.activeElement;g.contains(o)||o===v?e.shiftKey?o===t&&setTimeout((()=>{const e=document.activeElement;g.contains(e)||G()}),0):o===n&&setTimeout((()=>{const e=document.activeElement;g.contains(e)||G()}),0):G()}function $(e){if(!c.isCoursesOpen||!g)return;const t=document.activeElement,n=c.focusableElements,o=n.indexOf(t);if(-1===o)return;let i=o;switch(e.key){case"ArrowDown":e.preventDefault(),i=(o+1)%n.length;break;case"ArrowUp":e.preventDefault(),i=(o-1+n.length)%n.length;break;case"Home":e.preventDefault(),i=0;break;case"End":e.preventDefault(),i=n.length-1;break;case"Escape":return e.preventDefault(),void G();default:return}n[i]?.focus()}function H(){c.isMobileCoursesOpen=!c.isMobileCoursesOpen,T&&T.setAttribute("aria-expanded",c.isMobileCoursesOpen.toString()),A&&(c.isMobileCoursesOpen?A.classList.add("active"):A.classList.remove("active"))}function z(){c.isMobileGroupTrainingOpen=!c.isMobileGroupTrainingOpen,M&&M.setAttribute("aria-expanded",c.isMobileGroupTrainingOpen.toString()),C&&(c.isMobileGroupTrainingOpen?C.classList.add("active"):C.classList.remove("active"))}l&&l.addEventListener("click",(()=>{O()})),p&&p.addEventListener("click",(()=>{q()}));const P=document.getElementById("search-modal-submit");P&&P.addEventListener("click",I),m&&(m.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),I())})),m.addEventListener("input",(function(){if(!m)return;b&&clearTimeout(b);const e=m.value;b=setTimeout((()=>{B(e)}),300)})));const N=u?.querySelector(".search-modal-backdrop");function V(){const e=document.getElementById("mobile-menu-button");e&&!e.dataset.handlerAttached&&(e.dataset.handlerAttached="true",e.removeAttribute("onclick"),e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),window.toggleMobileMenu()})))}N&&N.addEventListener("click",q),d&&d.addEventListener("click",(e=>{e.stopPropagation()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&(c.isCoursesOpen?(e.preventDefault(),G()):c.isSearchOpen?q():c.isMobileMenuOpen&&closeMobileMenu())})),document.addEventListener("keydown",(function(e){if(!c.isSearchOpen||!d)return;if("Tab"!==e.key)return;const t=d.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],o=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),o?.focus()):document.activeElement===o&&(e.preventDefault(),n?.focus())})),v&&g&&w&&(w.addEventListener("mouseenter",D),w.addEventListener("mouseleave",W),v.addEventListener("focus",(function(){c.isCoursesOpen||(c.isCoursesOpen=!0,c.lastFocusedElement=document.activeElement,v&&v.setAttribute("aria-expanded","true"),g&&(g.classList.add("active"),g.setAttribute("aria-hidden","false"),R(),Y(!0),setTimeout((()=>{const e=g.querySelector('[role="menuitem"]');e&&e.focus()}),50)))})),v.addEventListener("blur",(function(e){w&&!w.contains(e.relatedTarget)&&setTimeout((()=>{c.isCoursesOpen=!1,v&&v.setAttribute("aria-expanded","false"),g&&g.classList.remove("active")}),150)})),v.addEventListener("keydown",(function(e){"Enter"===e.key||" "===e.key?(e.preventDefault(),c.isCoursesOpen?G():(D(),setTimeout((()=>{const e=g?.querySelector('[role="menuitem"]');e&&e.focus()}),50))):"Escape"===e.key?c.isCoursesOpen&&(e.preventDefault(),G()):"ArrowDown"!==e.key||c.isCoursesOpen||(e.preventDefault(),D(),setTimeout((()=>{const e=g?.querySelector('[role="menuitem"]');e&&e.focus()}),50))})),g.addEventListener("mouseenter",(()=>{c.coursesTimeout&&(clearTimeout(c.coursesTimeout),c.coursesTimeout=null),c.isCoursesOpen||D()})),g.addEventListener("mouseleave",W),g.querySelectorAll("a").forEach((e=>{e.addEventListener("keydown",(e=>{"Escape"===e.key&&G()}))}))),y&&y.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),G()})),document.addEventListener("click",(e=>{if(c.isCoursesOpen&&g&&w){w.contains(e.target)||g.contains(e.target)||G()}})),E&&L&&k&&(k.addEventListener("mouseenter",(function(){c.groupTrainingTimeout&&(clearTimeout(c.groupTrainingTimeout),c.groupTrainingTimeout=null),c.isGroupTrainingOpen=!0,L&&L.classList.add("active")})),k.addEventListener("mouseleave",(function(){c.groupTrainingTimeout=setTimeout((()=>{c.isGroupTrainingOpen=!1,L&&L.classList.remove("active")}),150)})),E.addEventListener("focus",(function(){c.isGroupTrainingOpen=!0,L&&L.classList.add("active")})),E.addEventListener("blur",(function(e){k&&!k.contains(e.relatedTarget)&&setTimeout((()=>{c.isGroupTrainingOpen=!1,L&&L.classList.remove("active")}),150)})),E.addEventListener("keydown",(function(e){if("ArrowDown"===e.key&&c.isGroupTrainingOpen){e.preventDefault();const t=L?.querySelector("a");t?.focus()}else"Escape"===e.key&&(c.isGroupTrainingOpen=!1,E&&E.focus(),L&&L.classList.remove("active"))})),L.querySelectorAll("a").forEach((e=>{e.addEventListener("keydown",(e=>{"Escape"===e.key&&(c.isGroupTrainingOpen=!1,E&&E.focus(),L&&L.classList.remove("active"))}))}))),V(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",V):setTimeout(V,0);new MutationObserver((function(e){V()})).observe(document.body,{childList:!0,subtree:!0}),setTimeout(V,500);const K=document.getElementById("mobile-search-button");if(K&&K.addEventListener("click",(()=>{O(),closeMobileMenu()})),x&&x.querySelectorAll("a").forEach((e=>{e.addEventListener("click",closeMobileMenu)})),T&&T.addEventListener("click",H),M&&M.addEventListener("click",z),v&&v.setAttribute("aria-expanded","false"),g&&(g.setAttribute("aria-hidden","true"),Y(!1)),S&&S.setAttribute("aria-expanded","false"),u&&u.setAttribute("aria-hidden","true"),T&&T.setAttribute("aria-expanded","false"),M&&M.setAttribute("aria-expanded","false"),window.addEventListener("resize",(()=>{window.innerWidth>=768&&c.isMobileMenuOpen&&closeMobileMenu()})),window.openSearchModal=O,window.closeSearchModal=q,window.handleSearchModalSubmit=I,window.toggleMobileCourses=H,window.toggleMobileGroupTraining=z,window.innerWidth>=1024){const e=document.querySelector("#main-content > section.about-cta-modern"),t=e?.querySelector(".about-cta-modern-image");if(e&&t){let n=!1,o=window.scrollY;const i=function(){n||(window.requestAnimationFrame((function(){const i=window.scrollY,s=e.getBoundingClientRect(),r=window.innerHeight;if(s.top<r&&s.bottom>0){const e=i-o,n=t.style.transform||"translateY(0px)",s=parseFloat(n.match(/translateY\((-?\d+\.?\d*)px\)/)?.[1]||0),r=Math.max(-4,Math.min(0,s-.1*e));t.style.transform=`translateY(${r}px)`}else t.style.transform="";o=i,n=!1})),n=!0)};window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",(function(){window.innerWidth<1024&&t&&(t.style.transform="")}))}}const U=document.querySelectorAll(".about-cta-modern-stat-card");if(U.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&(t.target.style.animationPlayState="running",e.unobserve(t.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"});U.forEach((function(t){t.style.animationPlayState="paused",e.observe(t)}))}const _=document.querySelectorAll(".process-card");if(_.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&(t.target.classList.add("process-visible"),e.unobserve(t.target))}))}),{threshold:.15,rootMargin:"0px 0px -80px 0px"});_.forEach((function(t){e.observe(t)}))}function j(){const e=document.querySelector(".process-card-1"),t=document.querySelector(".process-card-2"),n=document.querySelector(".process-card-3"),o=document.querySelector(".process-connector-1-2"),i=document.querySelector(".process-connector-2-3"),s=document.querySelector(".process-grid");if(!(e&&t&&n&&o&&i&&s))return;const r=s.getBoundingClientRect(),a=(e.getBoundingClientRect(),t.getBoundingClientRect(),n.getBoundingClientRect(),e.querySelector(".process-number-circle")),c=t.querySelector(".process-number-circle"),l=n.querySelector(".process-number-circle");if(!a||!c||!l)return;const u=a.getBoundingClientRect(),d=c.getBoundingClientRect(),m=l.getBoundingClientRect(),p=u.bottom-r.top,f=d.top-r.top,b=u.left+u.width/2-r.left;o.style.left=b+"px",o.style.top=p+"px",o.style.height=f-p+"px";const h=d.bottom-r.top,v=m.top-r.top,g=d.left+d.width/2-r.left;i.style.left=g+"px",i.style.top=h+"px",i.style.height=v-h+"px"}document.querySelector(".process-grid")&&(j(),window.addEventListener("resize",j),setTimeout(j,1e3));const Q=document.getElementById("booking-enquiry-form");function J(){const e=document.getElementById("categories-load-more"),t=document.querySelectorAll(".category-card-hidden");e&&t.length>0&&(e.getAttribute("aria-label")||e.setAttribute("aria-label","Show all training categories"),e.addEventListener("click",(function(){const n="true"===e.getAttribute("aria-expanded"),o=e.querySelector(".load-more-text");n?(t.forEach((e=>{e.classList.remove("category-card-visible")})),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Show all training categories"),o&&(o.textContent="View All Categories")):(t.forEach((e=>{e.classList.add("category-card-visible")})),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Hide additional training categories"),o&&(o.textContent="Show Less Categories"),t[0]&&t[0].scrollIntoView({behavior:"smooth",block:"nearest"}))})))}function X(){if(window.innerWidth<768){document.querySelectorAll("#mobile-menu-content .mobile-menu-link").forEach((e=>{e.classList.remove("active"),e.removeAttribute("data-active"),e.removeAttribute("aria-current")}));document.getElementById("mobile-menu-content")}}Q&&Q.addEventListener("submit",(function(e){e.preventDefault();const t=document.getElementById("booking-consent");if(!t||!t.checked)return alert("Please provide consent to be contacted before submitting your enquiry."),void t.focus();const n=new FormData(Q),o=n.get("name"),i=n.get("email"),s=n.get("phone")||"Not provided",r=n.get("interest"),a="mailto:enquiries@continuitytrainingacademy.co.uk?subject="+encodeURIComponent("Training Booking Enquiry from "+o)+"&body="+encodeURIComponent("New booking enquiry:\n\nName: "+o+"\nEmail: "+i+"\nPhone: "+s+"\nInterested in: "+r+"\nConsent to contact: Yes\n\nPlease contact them to discuss their training needs.");window.showThankYouModal?(window.showThankYouModal("Thanks for your booking enquiry! We've received it and will be in touch soon.",{nextSteps:"We'll send you booking details via email shortly."}),setTimeout((function(){window.location.href=a}),300)):window.location.href=a,Q.reset(),t&&(t.checked=!1)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",J):J(),document.getElementById("homepage-sticky-cta")&&function(){try{const t=document.getElementById("homepage-sticky-cta"),n=document.getElementById("cta-centered-section");if(!t)return;let o=0,i=!1;function s(){i||(window.requestAnimationFrame((()=>{try{const e=window.pageYOffset||document.documentElement.scrollTop,i=window.innerWidth<768,s=document.querySelector(".site-footer, .site-footer-modern");if(e>200)if(i){if(n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0?(t.classList.remove("visible"),t.classList.add("hidden-mobile")):t.classList.remove("hidden-mobile")}if(s){if(s.getBoundingClientRect().top<window.innerHeight+300)t.classList.remove("visible"),t.classList.add("hidden-near-footer");else if(t.classList.remove("hidden-near-footer"),n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0||t.classList.add("visible")}else t.classList.add("visible")}else if(n){const e=n.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0||(t.classList.remove("hidden-mobile"),t.classList.add("visible"))}else t.classList.add("visible")}else t.classList.add("visible");else t.classList.remove("visible"),t.classList.remove("hidden-mobile"),t.classList.remove("hidden-near-footer");o=e}catch(t){e&&console.error("Error in sticky CTA scroll handler:",t)}finally{i=!1}})),i=!0)}t.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation();try{n?(n.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout((()=>{try{const e=n.querySelector('input[type="text"], input[type="tel"], input[type="email"]');e&&e.focus()}catch(t){e&&console.warn("Could not focus form input:",t)}}),500)):window.location.href="contact.html"}catch(t){e&&console.error("Error in sticky CTA click handler:",t)}})),s(),window.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0})}catch(r){e&&console.error("Error initializing sticky CTA:",r)}}(),document.getElementById("exit-intent-modal")&&function(){try{const t=document.getElementById("exit-intent-modal"),n=document.getElementById("exit-intent-form"),o=document.getElementById("exit-intent-email"),i=t?.querySelector(".exit-intent-modal-close"),s=t?.querySelector(".exit-intent-dismiss"),r=t?.querySelector(".exit-intent-modal-backdrop");if(!t)return;let a,c,l;try{a=localStorage.getItem("exitIntentDismissed"),c=localStorage.getItem("exitIntentDate"),l=(new Date).toDateString()}catch(g){e&&console.warn("localStorage not available for exit-intent popup")}if("true"===a&&c===l)return;let u=!1,d=0,m=null;function p(e){u||(m&&clearTimeout(m),m=setTimeout((()=>{!e.relatedTarget&&!e.toElement&&e.clientY<10&&(u=!0,f())}),100))}function f(){try{t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden";const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),o=n[0],i=n[n.length-1];function s(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),i?.focus()):document.activeElement===i&&(e.preventDefault(),o?.focus()))}o&&setTimeout((()=>{try{o.focus()}catch(t){e&&console.warn("Could not focus exit-intent modal element:",t)}}),100),t.addEventListener("keydown",s),t._trapFocus=s}catch(r){e&&console.error("Error showing exit-intent modal:",r)}}function b(){try{t.setAttribute("aria-hidden","true"),document.body.style.overflow="",t._trapFocus&&(t.removeEventListener("keydown",t._trapFocus),delete t._trapFocus)}catch(t){e&&console.error("Error closing exit-intent modal:",t)}}function h(){try{"undefined"!=typeof localStorage&&(localStorage.setItem("exitIntentDismissed","true"),localStorage.setItem("exitIntentDate",l))}catch(t){e&&console.warn("Could not save exit-intent preference:",t)}}function v(e){"Escape"===e.key&&"false"===t.getAttribute("aria-hidden")&&b()}document.addEventListener("mouseout",p,!1),document.addEventListener("mousemove",(e=>{d=e.clientY}),{passive:!0}),i&&i.addEventListener("click",(()=>{h(),b()})),s&&s.addEventListener("click",(()=>{h(),b()})),r&&r.addEventListener("click",(()=>{h(),b()})),document.addEventListener("keydown",v),n&&n.addEventListener("submit",(t=>{t.preventDefault();try{const e=o?.value;e&&("undefined"!=typeof localStorage&&(localStorage.setItem("exitIntentSubmitted","true"),localStorage.setItem("exitIntentDate",l)),b())}catch(t){e&&console.error("Error submitting exit-intent form:",t)}}))}catch(y){e&&console.error("Error initializing exit-intent popup:",y)}}(),X(),window.addEventListener("resize",X,{passive:!0}),window.addEventListener("scroll",(()=>{window.innerWidth<768&&X()}),{passive:!0});const Z=document.getElementById("mobile-menu-content");function ee(){const e=document.getElementById("footer-newsletter-form");e&&"true"!==e.dataset?.ctaBound&&(e.dataset.ctaBound="true",e.addEventListener("submit",(t=>{t.preventDefault();const n=e.querySelector('input[type="email"]'),o=e.querySelector('input[name="consent"]');if(o&&!o.checked)return void o.focus();n?.value?.trim()??""?("function"==typeof window.showThankYouModal?window.showThankYouModal("You're all set! We're excited to share training insights and CQC updates with you.",{nextSteps:"Keep an eye on your inboxâ€”we'll send you the latest news and training opportunities. You can unsubscribe anytime."}):alert("You're all set! We're excited to share training insights and CQC updates with you."),e.reset()):n?.focus()})))}Z&&Z.addEventListener("click",(e=>{if(e.target.classList.contains("mobile-menu-link")){document.querySelectorAll("#mobile-menu-content .mobile-menu-link").forEach((t=>{t!==e.target&&(t.classList.remove("active"),t.removeAttribute("data-active"),t.removeAttribute("aria-current"))}))}}),{passive:!0}),function(){const e=document.getElementById("back-to-top");if(!e)return;function t(){(window.pageYOffset||document.documentElement.scrollTop)>300?(e.classList.add("visible"),e.setAttribute("aria-hidden","false")):(e.classList.remove("visible"),e.setAttribute("aria-hidden","true"))}let n=!1;e.addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("main-content");t&&(t.setAttribute("tabindex","-1"),t.focus(),setTimeout((()=>{t.removeAttribute("tabindex")}),100)),window.scrollTo({top:0,behavior:"smooth"})})),window.addEventListener("scroll",(function(){n||(window.requestAnimationFrame((function(){t(),n=!1})),n=!0)}),{passive:!0}),t()}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",ee):ee()}();