!function(){"use strict";const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,t=document.getElementById("contact-form"),n=document.getElementById("contact-form-submit"),o=document.getElementById("contact-form-submit-text"),r=document.getElementById("contact-form-submit-loading"),a=document.getElementById("contact-form-success"),i=document.getElementById("contact-form-clear"),s=document.getElementById("name"),c=document.getElementById("email"),l=document.getElementById("phone"),d=document.getElementById("organisation"),u=document.getElementById("enquiryType"),m=document.getElementById("message"),y=document.getElementById("contact-consent"),p=document.getElementById("name-error"),f=document.getElementById("email-error"),g=document.getElementById("message-error"),h=document.getElementById("enquiryType-error");let v=!1,b={};const E={name:"Name is required",email:"Email is required",emailInvalid:"Please enter a valid email address",phone:"Phone number is required",phoneInvalid:"Please enter a valid UK phone number (e.g., 01622 587343 or +44 1622 587343)",enquiryType:"Please select an enquiry type",message:"Message is required",messageMaxLength:"Message must be 1000 characters or less",consent:"You must agree to be contacted to submit this form"};function w(e){if(!e)return{valid:!1,error:E.phone};const t=e.replace(/[\s\-\(\)]/g,"");return/^(\+44|0044|0)?[1-9]\d{8,9}$/.test(t)?{valid:!0,error:null}:{valid:!1,error:E.phoneInvalid}}function I(){if(!t)return;function e(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>{clearTimeout(n),e(...o)}),t)}}!function(){if(!u)return;const e=new URLSearchParams(window.location.search).get("type");if(e){const t={"schedule-call":"schedule-call","group-training":"group-training","book-course":"book-course","cqc-training":"cqc-training",support:"support",general:"general"}[e]||e;if(u.querySelector(`option[value="${t}"]`))return u.value=t,void L("url_param",t)}const t=document.referrer;if(t){const e=new URL(t),n=e.pathname.toLowerCase(),o=e.hostname.toLowerCase();if(o===window.location.hostname.toLowerCase()||o.includes("continuitytrainingacademy")){let t=null;if(n.includes("group-training"))t="group-training";else if(n.includes("calendar")||n.includes("courses"))t="book-course";else if(n.includes("cqc-changes")||n.includes("news")||n.includes("article"))t="cqc-training";else if(n.includes("faq"))t="support";else if(n.includes("index")||"/"===n||""===n){const n=e.hash;n&&n.includes("callback")&&(t="schedule-call")}t&&u.querySelector(`option[value="${t}"]`)&&(u.value=t,L("referrer",t))}}}(),t.addEventListener("submit",T),i&&i.addEventListener("click",(e=>{e.preventDefault();if(s.value.trim()||c.value.trim()||l.value.trim()||m&&m.value.trim()){if(!window.confirm("Are you sure you want to clear the form? All entered information will be lost."))return}M();const t=document.getElementById("contact-form");t&&t.scrollIntoView({behavior:"smooth",block:"start"}),window.innerWidth>=768&&s&&setTimeout((()=>{s.focus()}),300)}));const n=e((()=>{S("name"),k(),C("name")}),300),o=e((()=>{S("email"),k(),C("email")}),300),r=e((()=>{S("phone"),k(),C("phone")}),300);s.addEventListener("input",n),c.addEventListener("input",o),l.addEventListener("input",r),d&&d.addEventListener("input",(()=>k())),u&&u.addEventListener("change",(()=>{S("enquiryType"),k(),q(),L()}));const a=e((()=>{S("message"),k(),C("message")}),300);m.addEventListener("input",(()=>{x(),a()})),m&&(x(),m.addEventListener("paste",(()=>{setTimeout(x,10)}))),q(),k();const v=e=>{!function(e,t=!1){const n={};if("name"===e){s.value.trim()||(n.name=E.name)}else if("email"===e){const e=c.value.trim();e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||(n.email=E.emailInvalid):n.email=E.email}else if("phone"===e){const e=w(l.value.trim());e.valid||(n.phone=e.error)}else if("message"===e){const e=m.value.trim();if(e){const t=parseInt(m.getAttribute("maxlength"))||1e3;e.length>t&&(n.message=E.messageMaxLength)}else n.message=E.message}else if("enquiryType"===e&&u){u.value||(n.enquiryType=E.enquiryType)}n[e]?b[e]=n[e]:delete b[e];t||window.innerWidth<768?function(){const e=document.getElementById("contact-form-error-summary"),t=document.getElementById("contact-form-error-list"),n=Object.keys(b).length;if(e&&t)if(n>0){t.innerHTML="";["name","email","phone","enquiryType","message","consent"].filter((e=>b[e])).forEach(((e,n)=>{const o=document.createElement("li"),r=document.createElement("a");r.href=`#${e}`,r.textContent=b[e],r.className="contact-form-error-link",r.addEventListener("click",(t=>{t.preventDefault();const n=document.getElementById(e);n&&(window.innerWidth>=768&&n.focus(),n.scrollIntoView({behavior:"smooth",block:"center"}))})),o.appendChild(r),t.appendChild(o)})),e.style.display="flex"}else e.style.display="none",e.removeAttribute("tabindex");b.name?(p.textContent=b.name,p.style.display="block",s.setAttribute("aria-invalid","true"),s.classList.add("contact-form-input-error"),C("name")):(S("name"),C("name"));b.email?(f.textContent=b.email,f.style.display="block",c.setAttribute("aria-invalid","true"),c.classList.add("contact-form-input-error"),C("email")):(S("email"),C("email"));if(b.phone){const e=document.getElementById("phone-error");e&&(e.textContent=b.phone,e.style.display="block"),l&&(l.setAttribute("aria-invalid","true"),l.classList.add("contact-form-input-error"),C("phone"))}else S("phone"),C("phone");b.message?(g.textContent=b.message,g.style.display="block",m.setAttribute("aria-invalid","true"),m.classList.add("contact-form-input-error"),C("message")):(S("message"),C("message"));b.enquiryType?(h&&(h.textContent=b.enquiryType,h.style.display="block"),u&&(u.setAttribute("aria-invalid","true"),u.classList.add("contact-form-select-error"),C("enquiryType"))):(S("enquiryType"),C("enquiryType"));if(b.consent){const e=document.getElementById("consent-error");e&&(e.textContent=b.consent,e.style.display="block"),y&&(y.setAttribute("aria-invalid","true"),y.classList.add("contact-form-input-error"))}else{const e=document.getElementById("consent-error");e&&(e.style.display="none",e.textContent=""),y&&(y.setAttribute("aria-invalid","false"),y.classList.remove("contact-form-input-error"))}}():A()}(e)};s.addEventListener("blur",(()=>v("name"))),c.addEventListener("blur",(()=>v("email"))),l.addEventListener("blur",(()=>v("phone"))),m.addEventListener("blur",(()=>v("message"))),u&&u.addEventListener("blur",(()=>v("enquiryType"))),y&&y.addEventListener("change",(()=>{y.checked&&S("consent")})),k(),function(){const e=new URLSearchParams(window.location.search),t=document.getElementById("utm_source"),n=document.getElementById("utm_medium"),o=document.getElementById("utm_campaign");t&&(t.value=e.get("utm_source")||"");n&&(n.value=e.get("utm_medium")||"");o&&(o.value=e.get("utm_campaign")||"");const r=document.getElementById("referrer");if(r){const e=document.referrer;if(e)try{const t=new URL(e),n=window.location.hostname.toLowerCase(),o=t.hostname.toLowerCase();o===n||o.includes("continuitytrainingacademy")||(r.value=e)}catch(t){r.value=e}}const a=document.getElementById("internal_source");if(a){const t=e.get("source");if(t)a.value=t;else{const e=document.referrer;if(e)try{const t=new URL(e),n=window.location.hostname.toLowerCase(),o=t.hostname.toLowerCase();(o===n||o.includes("continuitytrainingacademy"))&&(a.value=t.pathname)}catch(e){}}}}();const I=document.querySelector(".contact-providers-cta-button");I&&I.addEventListener("click",(e=>{e.preventDefault(),B()}));const _=document.getElementById("contact-hero-jump-link");_&&_.addEventListener("click",(e=>{e.preventDefault(),B()}));const D=document.getElementById("contact-floating-cta");if(D){const e=D.querySelector("a");e&&e.addEventListener("click",(e=>{e.preventDefault(),B()}));let t=0;window.addEventListener("scroll",(()=>{const e=window.pageYOffset||document.documentElement.scrollTop,n=document.getElementById("contact-form");if(n&&window.innerWidth<768){n.getBoundingClientRect().top+window.pageYOffset>e+window.innerHeight&&e>200?D.classList.add("visible"):D.classList.remove("visible")}t=e}))}}function L(e,t){if(!u)return;const n=t||u.value;n&&("undefined"!=typeof gtag&&gtag("event","enquiry_type_selected",{enquiry_type:n,source:e||"manual",page_location:window.location.href}),"undefined"!=typeof ga&&ga("send","event","Contact Form","Enquiry Type Selected",n),"function"==typeof window.trackEvent&&window.trackEvent("enquiry_type_selected",{type:n,source:e||"manual"}))}function B(){const e=document.getElementById("contact-form");e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout((()=>{s&&s.focus()}),500))}function k(){const e=document.getElementById("contact-form-progress-fill"),t=document.getElementById("contact-form-progress-current"),n=document.getElementById("contact-form-progress-total");if(!e||!t)return;let o=0;s&&s.value.trim()&&o++,c&&c.value.trim()&&o++,u&&u.value&&o++,m&&m.value.trim()&&o++;const r=o/4*100;e&&(e.style.width=r+"%"),t&&(t.textContent=o),n&&(n.textContent=4)}function x(){const e=document.getElementById("message-counter");if(e&&m){const t=m.value.length,n=parseInt(m.getAttribute("maxlength"))||1e3;e.textContent=`${t}/${n}`;const o=n-t;e.classList.remove("contact-form-char-counter-warning","contact-form-char-counter-error"),o<50&&o>=0?e.classList.add("contact-form-char-counter-warning"):o<0&&e.classList.add("contact-form-char-counter-error")}}function q(){const e=document.getElementById("organisation-field-wrapper");if(!e||!u)return;const t=u.value,n="booking"===t||"group"===t;if(n){e.style.display="block";const t=e.closest(".contact-form-grid");t&&(t.style.gridTemplateColumns="repeat(2, 1fr)")}else{e.style.display="none";e.closest(".contact-form-grid")}}function T(t){if(t.preventDefault(),v)return;const i=document.getElementById("website");if(i&&""!==i.value)return;const d=function(){const e={};s.value.trim()||(e.name=E.name);const t=c.value.trim();t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(e.email=E.emailInvalid):e.email=E.email;const n=w(l.value.trim());n.valid||(e.phone=n.error);if(u){u.value||(e.enquiryType=E.enquiryType)}const o=m.value.trim();if(o){const t=parseInt(m.getAttribute("maxlength"))||1e3;o.length>t&&(e.message=E.messageMaxLength)}else e.message=E.message;y&&y.checked||(e.consent=E.consent);return e}();if(Object.keys(d).length>0){if(b=d,A(),window.innerWidth>=768){const e=Object.keys(d)[0],t=document.getElementById(e);t&&setTimeout((()=>{t.focus()}),100)}return}const p=document.getElementById("submission_timestamp");p&&(p.value=(new Date).toISOString()),b={},_(),function(){v=!0,n.disabled=!0,n.setAttribute("aria-busy","true"),o.style.display="none",r.style.display="inline",n.setAttribute("aria-label","Sending message, please wait..."),a.style.display="none";try{setTimeout((()=>{v=!1,n.disabled=!1,n.setAttribute("aria-busy","false"),n.removeAttribute("aria-label"),o.style.display="inline",r.style.display="none","function"==typeof window.trackFormSubmission&&window.trackFormSubmission();const e=u?.value||"";let t="Thanks for reaching out! We've received your message and someone from our team will be in touch.",i="";const s={"schedule-call":{method:"phone call"},"group-training":{method:"email"},"book-course":{method:"email"},"cqc-training":{method:"email"},support:{method:"email"},general:{method:"email"}};if(e&&s[e]){const{method:t}=s[e];i=`We'll reach out via ${t} shortly.`}else i="We'll be in touch shortly.";window.showThankYouModal&&window.showThankYouModal(t,{nextSteps:i}),M();const c=document.getElementById("contact-consent");c&&(c.checked=!1),a&&(a.setAttribute("tabindex","-1"),setTimeout((()=>{a.focus()}),100))}),2e3)}catch(t){e&&console.error("Form submission error:",t),v=!1,n.disabled=!1,n.setAttribute("aria-busy","false"),n.removeAttribute("aria-label"),o.style.display="inline",r.style.display="none";const a=document.getElementById("contact-form-error-summary"),i=document.getElementById("contact-form-error-list");a&&i&&(i.innerHTML="<li>Unable to send message. Please try again or contact us directly.</li>",a.style.display="flex",a.scrollIntoView({behavior:"smooth",block:"center"}))}}()}function A(){const e=document.getElementById("contact-form-error-summary"),t=document.getElementById("contact-form-error-list"),n=Object.keys(b).length,o=window.innerWidth<768;if(e&&t)if(n>0){t.innerHTML="";const n=["name","email","phone","enquiryType","message","consent"].filter((e=>b[e]));n.forEach(((e,n)=>{const r=document.createElement("li"),a=document.createElement("a");a.href=`#${e}`,a.textContent=b[e],a.className="contact-form-error-link",a.addEventListener("click",(t=>{t.preventDefault();const n=document.getElementById(e);n&&(o||n.focus(),n.scrollIntoView({behavior:"smooth",block:"center"}))})),r.appendChild(a),t.appendChild(r)})),e.style.display="flex",setTimeout((()=>{if(e.scrollIntoView({behavior:"smooth",block:"center"}),o)e.setAttribute("tabindex","-1");else{e.focus(),e.setAttribute("tabindex","-1");const t=n[0];t&&setTimeout((()=>{const e=document.getElementById(t);e&&e.focus()}),300)}}),100)}else e.style.display="none",e.removeAttribute("tabindex");if(b.name?(p.textContent=b.name,p.style.display="block",s.setAttribute("aria-invalid","true"),s.classList.add("contact-form-input-error"),C("name")):(S("name"),C("name")),b.email?(f.textContent=b.email,f.style.display="block",c.setAttribute("aria-invalid","true"),c.classList.add("contact-form-input-error"),C("email")):(S("email"),C("email")),b.phone){const e=document.getElementById("phone-error");e&&(e.textContent=b.phone,e.style.display="block"),l&&(l.setAttribute("aria-invalid","true"),l.classList.add("contact-form-input-error"),C("phone"))}else S("phone"),C("phone");if(b.message?(g.textContent=b.message,g.style.display="block",m.setAttribute("aria-invalid","true"),m.classList.add("contact-form-input-error"),C("message")):(S("message"),C("message")),b.enquiryType?(h&&(h.textContent=b.enquiryType,h.style.display="block"),u&&(u.setAttribute("aria-invalid","true"),u.classList.add("contact-form-select-error"),C("enquiryType"))):(S("enquiryType"),C("enquiryType")),b.consent){const e=document.getElementById("consent-error");e&&(e.textContent=b.consent,e.style.display="block"),y&&(y.setAttribute("aria-invalid","true"),y.classList.add("contact-form-input-error"))}else{const e=document.getElementById("consent-error");e&&(e.style.display="none",e.textContent=""),y&&(y.setAttribute("aria-invalid","false"),y.classList.remove("contact-form-input-error"))}}function C(e){let t,n;if("name"===e)t=s,n=p;else if("email"===e)t=c,n=f;else if("phone"===e)t=l,n=document.getElementById("phone-error");else if("message"===e)t=m,n=g;else{if("enquiryType"!==e)return;t=u,n=h}if(!t)return;const o=t.closest(".contact-form-input-wrapper")||t.closest(".contact-form-textarea-wrapper")||t.closest(".contact-form-input-wrapper-new")||t.closest(".contact-form-textarea-wrapper-new")||t.closest(".contact-form-select-wrapper");if(!o)return;const r=o.querySelector(".contact-form-success-icon"),a=o.querySelector(".contact-form-error-icon");let i=!1;i="SELECT"===t.tagName?""!==t.value:t.checkValidity()&&""!==t.value.trim();t.classList.contains("contact-form-input-error")||t.classList.contains("contact-form-select-error")||n&&"none"!==n.style.display&&n.textContent?(r&&(r.style.display="none"),a&&(a.style.display="block")):i?(r&&(r.style.display="block"),a&&(a.style.display="none")):(r&&(r.style.display="none"),a&&(a.style.display="none"))}function S(e){const t=document.getElementById(e+"-error"),n=document.getElementById(e);t&&(t.style.display="none",t.textContent=""),n&&(n.setAttribute("aria-invalid","false"),n.classList.remove("contact-form-input-error"),n.classList.remove("contact-form-select-error"))}function _(){const e=document.getElementById("contact-form-error-summary");e&&(e.style.display="none"),[p,f,g,h].forEach((e=>{e&&(e.style.display="none",e.textContent="")}));const t=document.getElementById("phone-error");t&&(t.style.display="none",t.textContent=""),[s,c,l,m,u].forEach((e=>{e&&(e.setAttribute("aria-invalid","false"),e.classList.remove("contact-form-input-error"),e.id&&C(e.id))}))}function M(){const e=new URLSearchParams(window.location.search).get("type"),n=u?u.value:null;if(t.reset(),_(),b={},u)if(e){const t={"schedule-call":"schedule-call","group-training":"group-training","book-course":"book-course",support:"support",general:"general"}[e]||e;u.querySelector(`option[value="${t}"]`)&&(u.value=t)}else n&&""!==n&&(u.value=n);x(),k()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",I):I()}(),function(){"use strict";function e(){const e=document.querySelectorAll(".contact-faq-question");0!==e.length&&e.forEach((t=>{t.addEventListener("click",(function(){const n="true"===this.getAttribute("aria-expanded"),o=this.getAttribute("aria-controls"),r=document.getElementById(o);r&&(e.forEach((e=>{if(e!==t){e.setAttribute("aria-expanded","false");const t=e.getAttribute("aria-controls"),n=document.getElementById(t);n&&(n.setAttribute("aria-hidden","true"),n.style.maxHeight="0")}})),n?(this.setAttribute("aria-expanded","false"),r&&(r.setAttribute("aria-hidden","true"),r.style.maxHeight="0")):(this.setAttribute("aria-expanded","true"),r&&(r.setAttribute("aria-hidden","false"),r.style.maxHeight=r.scrollHeight+"px")))})),t.addEventListener("keydown",(function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.click())}))}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}();